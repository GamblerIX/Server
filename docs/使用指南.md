# 完整使用指南

本指南将帮助您在Windows上一步步运行鸣潮服务端和客户端，以游玩鸣潮2.5测试服。

## 环境配置（全程科学上网！！！）

### 第一步：安装Git

1. **下载安装程序**

   * 访问链接下载：<https://github.com/git-for-windows/git/releases/download/v2.50.1.windows.1/Git-2.50.1-64-bit.exe>

2. **运行安装程序**

   * 双击下载的安装文件

   * 始终保持默认选项，一路点击「Next」

   * 出现「Install」时点击

   * 安装完成后，点击「Finish」关闭安装程序

***

### 第二步：克隆项目

1. **打开 PowerShell（管理员）**

   * 按 Win+X，选择「Windows PowerShell (管理员)」
   > 或者按 Win+R，输入 `powershell`，然后按 Ctrl+Shift+Enter组合键

   * 注意：之后的指南将不再提示打开PowerShell，所有指令默认在PowerShell中执行。复制完任何指令一定要记得回车。

2. **创建文件夹并克隆项目**

   ```PowerShell
   New-Item -Path "D:\WuWaPS\" -ItemType Directory -Force
   cd "D:\WuWaPS"
   git clone https://github.com/GamblerIX/Server.git
   ```

3. **设置文件夹权限**

   ```PowerShell
   icacls "D:\WuWaPS" /grant Users:F /T
   ```

   > 如果系统默认已为Users用户组分配了完全控制权限，该命令会确认权限设置。

***

### 第三步：安装和配置 PostgreSQL 数据库

#### 下载和安装数据库

1. **下载安装程序**

   * 访问链接下载：<https://get.enterprisedb.com/postgresql/postgresql-17.5-3-windows-x64.exe>

2. **运行安装程序**

   * 双击下载的安装文件

   * 在安装过程中，当要求设置 postgres 用户密码时，请设置为：`Aa123456`

   * 其他选项保持默认，完成安装

#### 配置数据库

安装完成后，需要创建项目专用的数据库和用户：

1. **进入 PostgreSQL 安装目录**

   ```PowerShell
   Set-Location "C:\Program Files\PostgreSQL\17\bin"
   ```

3. **连接到数据库**

   ```PowerShell
   .\psql -U postgres -h 127.0.0.1 -p 5432
   ```

   > 系统会提示输入密码，输入 `Aa123456` 并回车
   > 注意：输入密码时不会显示任何字符。

   > 成功连接后会显示 `postgres=#` 提示符

4. **创建项目数据库**

   ```SQL
   CREATE DATABASE users;
   ```

   > 成功后会显示 `CREATE DATABASE`

5. **创建项目用户**

   ```SQL
   CREATE USER users WITH PASSWORD 'password';
   ```

   > 成功后会显示 `CREATE ROLE`

6. **切换到项目数据库**

   ```SQL
   \c users
   ```

   > 成功后会显示 `You are now connected to database "users" as user "postgres"`

7. **设置用户权限**
   依次执行以下命令：

   ```SQL
   GRANT CREATE, USAGE ON SCHEMA public TO users;
   ```

   ```SQL
   GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA public TO users;
   ```

   ```SQL
   ALTER DEFAULT PRIVILEGES IN SCHEMA public GRANT ALL PRIVILEGES ON TABLES TO users;
   ```

   > 成功后分别会显示 `GRANT`,`GRANT`,`ALTER DEFAULT PRIVILEGES`

8. **退出数据库终端**

   ```SQL
   \q
   ```

### 第四步：安装python

#### 下载和安装

1. **下载安装程序**

   * 访问链接：<https://www.python.org/ftp/python/3.13.6/python-3.13.6-amd64.exe>

2. **运行安装程序**

   * 双击下载的安装文件

   * 勾选「Add to PATH」

   * 点击「Install Now」

   * 安装完成后，点击「Close」关闭安装程序

### ✅ 环境验证

完成所有安装后，请验证三个组件都已正确安装：

1. 依次执行以下命令验证其中两个组件的安装：

```PowerShell
python --version
# 输出必须完全相同：Python 3.13.6
```

```PowerShell
git --version
# 输出必须完全相同：git version 2.50.1.windows.1
```

2. 验证PostgreSQL数据库安装

在开始菜单栏中找到PostgreSQL 17文件夹，点击打开其中的pgAdmin 4，成功进入则说明PostgreSQL数据库安装成功。

## 运行服务端（不要科学上网！！！）

1. **进入控制台主菜单**

   ```PowerShell
   cd D:\WuWaPS\Server\py
   pip install -r requirements.txt
   python main.py
   ```

2. **运行服务端**

   * 提示请选择操作后，输入运行服务端选项对应的数字并回车。
   * 脚本将检查环境，若通过将开始运行服务端。

> 小米管家和此服务端不能一同运行，脚本将尝试自动关闭小米管家。（占用端口10001重合）

3. **退出运行菜单**

   所有服务端启动完毕后，按下Ctrl+C组合键退出运行菜单。

> 恭喜！服务端已运行。

## 客户端配置（不要科学上网！！！）

### 第一步：下载客户端

1. 访问链接：<https://www.123865.com/s/87lLTd-nUt3A?pwd=r1nx>
> 声明：客户端使用123云盘分享没有任何牟利目的。

2. 存在三种推荐下载方法：
   1. PC登录直接下载（需要会员）
   2. 手机登录下载传到PC端（不限速但麻烦）
   3. PC端浏览器安装篡改猴插件，然后直接访问链接：<https://scriptcat.org/scripts/code/2385/123%20%E4%BA%91%E7%9B%98%E4%BC%9A%E5%91%98%E9%9D%92%E6%98%A5%E7%89%88.user.js>，选择安装脚本，然后登陆下载。（不限速但略微麻烦）

3. 解压下载的压缩包到`D:\WuWaPS\Client`文件夹，确保`Wuthering Waves.exe`在`D:\WuWaPS\Client`文件夹内。

### 第二步：补丁客户端

```PowerShell
Copy-Item "D:\WuWaPS\Server\release\wicked-waifus-win-cn_beta_2_5_1-regular.dll" "D:\WuWaPS\Client\Client\Binaries\Win64\" -Force
Copy-Item "D:\WuWaPS\Server\release\rr_fixes_100_p.pak" "D:\WuWaPS\Client\Client\Content\Paks\" -Force
Copy-Item "D:\WuWaPS\Server\release\launcher.exe" "D:\WuWaPS\Client\Client\Binaries\Win64\" -Force
Copy-Item "D:\WuWaPS\Server\release\config.toml" "D:\WuWaPS\Client\Client\Binaries\Win64\" -Force
```

### 第三步：运行补丁客户端

```PowerShell
Set-Location "D:\WuWaPS\Client\Client\Binaries\Win64"
.\launcher.exe
```

> 注意：进入客户端后不要使用快速新建/登录，可以使用任意 ID 进入游戏。

## 后续维护 

### 其一·停止服务端

1. **进入主菜单**

   ```PowerShell
   python main.py
   ```

2. **停止服务端**

   进入主菜单后，输入3并回车。
   脚本将提示是否停止服务端，输入y并回车确认停止服务端。
   脚本将检查服务端是否运行，随即停止运行的服务端。

### 其二·角色技能充能

全文替换修改`D:\WuWaPS\Server\release\data\assets\game-data\BinData\BaseProperty.json`中每个`CdReduse`、`EnergyMax`和`Energy`的值为`0`、`0`、`1`。

```json
{
  "CdReduse": 0,
  "EnergyMax": 0,
  "Energy": 1
}
```

这样就实现了无CD大招和满能量状态。

更多指南，敬请期待。